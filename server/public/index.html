<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Identity Recognition & OCR Demo</title>
    <link rel="stylesheet" href="css/style.css">
    <!-- TailwindCSS (Play CDN for rapid styling) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      // Minimal Tailwind config: enable dark mode by class if you toggle later
      tailwind.config = {
        darkMode: 'class',
        theme: { extend: {} }
      }
    </script>
</head>
<body>
    <div class="app-container min-h-screen bg-gray-50 text-gray-900">
        <header class="w-full border-b border-gray-200 bg-white">
            <div class="mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8">
                <h1 class="text-2xl font-semibold tracking-tight sm:text-3xl">Identity Recognition & OCR Demo</h1>
                <p class="mt-2 text-sm text-gray-600">Position your identity document within the guide rectangle for optimal OCR results</p>
            </div>
        </header>

        <main class="mx-auto max-w-7xl px-1 py-1 sm:px-1 lg:px-1">
            <!-- Face Recognition Section -->
            <div class="face-recognition-section mb-6 rounded-xl border border-gray-200 bg-white p-4 shadow-sm">
                <div class="flex items-center justify-between mb-4">
                    <div>
                        <h2 class="text-lg font-semibold">Face Liveness Detection</h2>
                        <p class="text-sm text-gray-600">Verify you are a real person before capturing your ID</p>
                    </div>
                    <div id="face-status-badge" class="px-3 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-600">
                        Not Started
                    </div>
                </div>
                
                <div class="grid grid-cols-1 gap-4 lg:grid-cols-2">
                    <!-- Face Camera -->
                    <div class="face-camera-container">
                        <div class="relative overflow-hidden rounded-xl border border-gray-200 bg-black shadow-sm">
                            <video id="face-video" autoplay muted playsinline class="h-80 w-full object-cover sm:h-96"></video>
                            <canvas id="face-canvas" style="display: none;"></canvas>
                            
                            <!-- Face guide overlay -->
                            <div class="pointer-events-none absolute inset-0 flex items-center justify-center">
                                <div id="face-guide-circle" class="face-guide-circle w-48 h-48 rounded-full border-4 border-dashed border-white/70 transition-all duration-300">
                                </div>
                                <!-- Centering indicator arrows -->
                                <div id="center-arrow-left" class="absolute left-4 text-white/0 transition-all duration-300">
                                    <svg class="w-8 h-8 animate-pulse" fill="currentColor" viewBox="0 0 24 24"><path d="M15.41 16.59L10.83 12l4.58-4.59L14 6l-6 6 6 6 1.41-1.41z"/></svg>
                                </div>
                                <div id="center-arrow-right" class="absolute right-4 text-white/0 transition-all duration-300">
                                    <svg class="w-8 h-8 animate-pulse" fill="currentColor" viewBox="0 0 24 24"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg>
                                </div>
                                <div id="center-arrow-up" class="absolute top-4 text-white/0 transition-all duration-300">
                                    <svg class="w-8 h-8 animate-pulse" fill="currentColor" viewBox="0 0 24 24"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6 1.41 1.41z"/></svg>
                                </div>
                                <div id="center-arrow-down" class="absolute bottom-12 text-white/0 transition-all duration-300">
                                    <svg class="w-8 h-8 animate-pulse" fill="currentColor" viewBox="0 0 24 24"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/></svg>
                                </div>
                            </div>
                            
                            <!-- Liveness feedback - moved outside circle -->
                            <div id="face-feedback" class="absolute left-1/2 bottom-2 -translate-x-1/2 rounded-lg bg-black/70 px-3 py-1.5 max-w-[90%]">
                                <div class="text-center text-xs font-semibold text-white">Press Start button below</div>
                            </div>
                            
                            <!-- Liveness progress bar -->
                            <div class="absolute top-2 left-1/2 -translate-x-1/2 w-[85%]">
                                <div class="flex items-center justify-between text-white text-xs mb-1">
                                    <span>Liveness</span>
                                    <span id="liveness-score" class="font-bold">0%</span>
                                </div>
                                <div class="bg-black/50 rounded-full h-3 overflow-hidden border border-white/30">
                                    <div id="liveness-progress" class="bg-green-500 h-full transition-all duration-300" style="width: 0%"></div>
                                </div>
                                <div id="steady-countdown" class="text-center text-xs text-white/80 mt-1 hidden">Hold steady: <span id="steady-seconds">3</span>s</div>
                            </div>
                        </div>
                        
                        <div class="mt-3 flex flex-wrap items-center gap-3">
                            <button id="start-face-detection" class="btn btn-primary inline-flex items-center justify-center rounded-md bg-green-600 px-4 py-2 text-sm font-medium text-white shadow hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500">
                                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                                </svg>
                                Start Face Detection
                            </button>
                            <button id="stop-face-detection" class="btn btn-secondary inline-flex items-center justify-center rounded-md bg-red-600 px-4 py-2 text-sm font-medium text-white shadow hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500" style="display: none;">
                                Stop Detection
                            </button>
                        </div>
                    </div>
                    
                    <!-- Captured Face Preview -->
                    <div class="face-preview-container">
                        <div class="rounded-xl border border-gray-200 bg-gray-50 p-4 h-full">
                            <h3 class="text-base font-medium mb-3">Captured Face</h3>
                            <div id="face-preview-wrapper" class="flex items-center justify-center min-h-[200px]">
                                <div id="face-no-capture" class="text-center text-gray-500">
                                    <svg class="w-16 h-16 mx-auto mb-2 text-gray-300" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/>
                                    </svg>
                                    <p class="text-sm">Face will be auto-captured when liveness is verified</p>
                                </div>
                                <img id="face-preview-image" class="max-h-64 w-auto max-w-full object-contain rounded-lg hidden" alt="Captured face" />
                            </div>
                            <div id="face-verification-result" class="mt-3 hidden">
                                <div class="flex items-center gap-2 text-sm">
                                    <span id="face-verified-icon" class="w-5 h-5"></span>
                                    <span id="face-verified-text"></span>
                                </div>
                                <p id="face-verified-details" class="text-xs text-gray-500 mt-1"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 gap-6 lg:grid-cols-2">
                <!-- Left: Camera + Controls -->
                <div class="camera-section space-y-4">
                    <div class="camera-container relative overflow-hidden rounded-xl border border-gray-200 bg-black shadow-sm">
                        <video id="video" autoplay muted playsinline class="h-64 w-full object-cover sm:h-72 md:h-80 lg:h-[26rem]"></video>
                        <canvas id="canvas" style="display: none;"></canvas>

                        <!-- Rectangle guide overlay -->
                        <div class="overlay-container pointer-events-none absolute inset-0 flex items-center justify-center">
                            <div class="guide-rectangle rounded-xl border-2 border-dashed border-white/70">
                                <div class="corner top-left"></div>
                                <div class="corner top-right"></div>
                                <div class="corner bottom-left"></div>
                                <div class="corner bottom-right"></div>
                            </div>

                            <!-- Alignment feedback -->
                            <div id="alignment-feedback" class="alignment-feedback absolute left-1/2 bottom-3 w-[94%] -translate-x-1/2 rounded-lg">
                                <div class="feedback-message text-center text-xs font-semibold tracking-wide text-white sm:text-sm">Center your document</div>
                            </div>
                        </div>
                    </div>

                    <div class="camera-controls flex flex-wrap items-center gap-3">
                        <button id="start-camera" class="btn btn-primary inline-flex items-center justify-center rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white shadow hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:cursor-not-allowed disabled:opacity-50">Start Camera</button>
                        <button id="switch-camera" class="btn btn-secondary inline-flex items-center justify-center rounded-md bg-gray-700 px-4 py-2 text-sm font-medium text-white shadow hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-gray-500 disabled:cursor-not-allowed disabled:opacity-50" style="display: none;" disabled>Switch Camera</button>
                        <button id="recapture-btn" class="btn btn-primary inline-flex items-center justify-center rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white shadow hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500" style="display: none;">Recapture</button>
                        <!-- Hidden OCR Type - Always Identity Document -->
                        <select id="ocr-type" style="display: none;">
                            <option value="identity" selected>Identity Document</option>
                        </select>
                    </div>
                </div>

                <!-- Right: Preview + Results -->
                <div class="results-section space-y-4">
                    <!-- Extracted Details Form -->
                    <div class="details-section rounded-xl border border-gray-200 bg-white p-4 shadow-sm">
                        <h3 class="text-base font-medium">Extracted Details</h3>
                        <div class="mt-3 grid grid-cols-1 gap-3 sm:grid-cols-2">
                            <!-- ID Type -->
                            <div>
                                <label for="id-type" class="mb-1 block text-xs font-medium text-gray-600">ID Type</label>
                                <select id="id-type" class="block w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-blue-500 focus:ring-blue-500">
                                    <option value="national-id" selected>National ID</option>
                                    <option value="passport">Passport</option>
                                    <option value="driver-license">Driver's License</option>
                                    <option value="umid">Unified Multi-Purpose Identification (UMID) Card</option>
                                    <option value="philhealth">PhilHealth ID</option>
                                    <option value="tin-id">TIN ID</option>
                                    <option value="postal-id">Postal ID Card</option>
                                    <option value="pagibig">Home Development Mutual Fund (Pag-IBIG) ID</option>
                                </select>
                            </div>
                            <!-- ID Number -->
                            <div>
                                <label for="id-number" class="mb-1 block text-xs font-medium text-gray-600">ID Number</label>
                                <input id="id-number" type="text" placeholder="Auto-filled from OCR" class="block w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-blue-500 focus:ring-blue-500" />
                            </div>

                            <!-- Last Name -->
                            <div>
                                <label for="last-name" class="mb-1 block text-xs font-medium text-gray-600">Last Name</label>
                                <input id="last-name" type="text" placeholder="Apelyido / Last Name" class="block w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-blue-500 focus:ring-blue-500" />
                            </div>
                            <!-- First Name -->
                            <div>
                                <label for="first-name" class="mb-1 block text-xs font-medium text-gray-600">First Name</label>
                                <input id="first-name" type="text" placeholder="Mga Pangalan / Given Names" class="block w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-blue-500 focus:ring-blue-500" />
                            </div>
                            <!-- Birth Date -->
                            <div>
                                <label for="birth-date" class="mb-1 block text-xs font-medium text-gray-600">Birth Date</label>
                                <input id="birth-date" type="date" class="block w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-blue-500 focus:ring-blue-500" />
                            </div>
                        </div>
                    </div>

                    <div class="preview-section rounded-xl border border-gray-200 bg-white p-4 shadow-sm">
                        <h3 class="text-base font-medium">Captured Image</h3>
                        <div class="image-preview mt-3 flex min-h-[160px] items-center justify-center overflow-hidden rounded-lg bg-gray-50">
                            <img id="preview-image" class="max-h-80 w-auto max-w-full object-contain" alt="Captured image will appear here" />
                            <div class="no-image text-sm text-gray-500">No image captured yet</div>
                        </div>
                    </div>

                    <div class="ocr-results rounded-xl border border-gray-200 bg-white p-4 shadow-sm">
                        <h3 class="text-base font-medium">OCR Results</h3>
                        <div class="loading mt-3 hidden items-center gap-2 text-sm text-gray-700" id="loading">
                            <div class="spinner h-5 w-5 animate-spin rounded-full border-2 border-blue-600 border-t-transparent"></div>
                            <span>Processing image...</span>
                        </div>

                        <div class="results-container mt-3 max-h-[22rem] overflow-auto rounded-md bg-gray-50 p-3 text-sm text-gray-800" id="results-container">
                            <div class="no-results text-gray-500">Process an image to see OCR results</div>
                        </div>
                    </div>

                    <!-- AI Results Panel -->
                    <div class="ai-results rounded-xl border border-gray-200 bg-white p-4 shadow-sm">
                        <h3 class="text-base font-medium">AI Results</h3>
                        <div id="ai-results-container" class="mt-3 rounded-md bg-gray-50 p-3 text-sm text-gray-800">
                            <div class="text-gray-500">AI will display extracted fields here when available.</div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="js/camera.js"></script>
    <script src="js/alignment.js"></script>
    <!-- Face Detection & Liveness -->
    <script src="js/face-scanning-algorithm/face-detection.js"></script>
    <!-- UMID scanning logic extracted from ocr.js -->
    <script src="js/scanning-algorithm/umid.js"></script>
    <!-- TIN ID scanning logic -->
    <script src="js/scanning-algorithm/tin-id.js"></script>
    <!-- Postal ID Card scanning logic -->
    <script src="js/scanning-algorithm/postal-id.js"></script>
    <!-- Pag-IBIG ID (HDMF) OCR-only scanning logic -->
    <script src="js/scanning-algorithm/pagibig.js"></script>
    <!-- Passport scanning logic extracted from ocr.js -->
    <script src="js/scanning-algorithm/passport.js"></script>
    <!-- Driver's License scanning logic extracted from ocr.js -->
    <script src="js/scanning-algorithm/driver-license.js"></script>
    <!-- PhilHealth scanning logic extracted from ocr.js -->
    <script src="js/scanning-algorithm/philhealth.js"></script>
    <!-- National ID scanning logic extracted from ocr.js -->
    <script src="js/scanning-algorithm/national-id.js"></script>
    <script src="js/ocr.js"></script>
    <script src="js/main.js"></script>
    <script>
      // Face Detection Initialization
      (function() {
        const faceVideo = document.getElementById('face-video');
        const faceCanvas = document.getElementById('face-canvas');
        const startFaceBtn = document.getElementById('start-face-detection');
        const stopFaceBtn = document.getElementById('stop-face-detection');
        const faceFeedback = document.getElementById('face-feedback');
        const faceStatusBadge = document.getElementById('face-status-badge');
        const livenessProgress = document.getElementById('liveness-progress');
        const livenessScore = document.getElementById('liveness-score');
        const facePreviewImage = document.getElementById('face-preview-image');
        const faceNoCapture = document.getElementById('face-no-capture');
        const faceVerificationResult = document.getElementById('face-verification-result');
        const faceVerifiedIcon = document.getElementById('face-verified-icon');
        const faceVerifiedText = document.getElementById('face-verified-text');
        const faceVerifiedDetails = document.getElementById('face-verified-details');

        let currentLivenessScore = 0;

        // Initialize Face Detection
        if (window.FaceDetection) {
          window.FaceDetection.init(faceVideo, faceCanvas, {
            onCapture: function(result) {
              // Show captured face
              facePreviewImage.src = result.imageDataUrl;
              facePreviewImage.classList.remove('hidden');
              faceNoCapture.classList.add('hidden');
              
              // Show verification result
              faceVerificationResult.classList.remove('hidden');
              if (result.isLive) {
                faceVerifiedIcon.innerHTML = '<svg class="w-5 h-5 text-green-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg>';
                faceVerifiedText.textContent = `Live Person Verified (${result.confidence}% confidence)`;
                faceVerifiedText.className = 'text-green-600 font-medium';
                faceStatusBadge.textContent = 'Verified';
                faceStatusBadge.className = 'px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-700';
              } else {
                faceVerifiedIcon.innerHTML = '<svg class="w-5 h-5 text-red-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/></svg>';
                faceVerifiedText.textContent = 'Liveness Check Failed';
                faceVerifiedText.className = 'text-red-600 font-medium';
                faceStatusBadge.textContent = 'Failed';
                faceStatusBadge.className = 'px-3 py-1 rounded-full text-xs font-medium bg-red-100 text-red-700';
              }
              faceVerifiedDetails.textContent = result.details || '';
              
              // Stop detection after successful capture
              stopFaceBtn.click();
            },
            onCentering: function(isCentered, details) {
              const guideCircle = document.getElementById('face-guide-circle');
              const arrowLeft = document.getElementById('center-arrow-left');
              const arrowRight = document.getElementById('center-arrow-right');
              const arrowUp = document.getElementById('center-arrow-up');
              const arrowDown = document.getElementById('center-arrow-down');
              
              // Hide all arrows first
              arrowLeft.className = 'absolute left-4 text-white/0 transition-all duration-300';
              arrowRight.className = 'absolute right-4 text-white/0 transition-all duration-300';
              arrowUp.className = 'absolute top-4 text-white/0 transition-all duration-300';
              arrowDown.className = 'absolute bottom-12 text-white/0 transition-all duration-300';
              
              if (isCentered) {
                // All green - face is centered!
                guideCircle.className = 'face-guide-circle w-48 h-48 rounded-full border-4 border-solid border-green-500 transition-all duration-300 shadow-lg shadow-green-500/50';
              } else if (details) {
                // Show which direction to move
                guideCircle.className = 'face-guide-circle w-48 h-48 rounded-full border-4 border-dashed border-yellow-500 transition-all duration-300';
                
                if (details.reason === 'tooFar') {
                  // Need to move closer - no arrows, just yellow
                } else {
                  // Show directional arrows
                  if (!details.isCenteredX) {
                    if (details.offsetX > 0.25) {
                      arrowLeft.className = 'absolute left-4 text-yellow-400 transition-all duration-300';
                    } else {
                      arrowRight.className = 'absolute right-4 text-yellow-400 transition-all duration-300';
                    }
                  }
                  if (!details.isCenteredY) {
                    if (details.offsetY > 0.25) {
                      arrowUp.className = 'absolute top-4 text-yellow-400 transition-all duration-300';
                    } else {
                      arrowDown.className = 'absolute bottom-12 text-yellow-400 transition-all duration-300';
                    }
                  }
                }
              } else {
                // No face detected - red/warning
                guideCircle.className = 'face-guide-circle w-48 h-48 rounded-full border-4 border-dashed border-white/70 transition-all duration-300';
              }
            },
            onStatus: function(message, type, score, secondsRemaining) {
              // Update feedback message
              const feedbackDiv = faceFeedback.querySelector('div');
              feedbackDiv.textContent = message;
              
              // Get countdown elements
              const steadyCountdown = document.getElementById('steady-countdown');
              const steadySeconds = document.getElementById('steady-seconds');
              
              // Update colors based on type
              if (type === 'success') {
                faceFeedback.className = 'absolute left-1/2 bottom-2 -translate-x-1/2 rounded-lg bg-green-600/80 px-3 py-1.5 max-w-[90%]';
              } else if (type === 'error') {
                faceFeedback.className = 'absolute left-1/2 bottom-2 -translate-x-1/2 rounded-lg bg-red-600/80 px-3 py-1.5 max-w-[90%]';
              } else if (type === 'warning') {
                faceFeedback.className = 'absolute left-1/2 bottom-2 -translate-x-1/2 rounded-lg bg-yellow-600/80 px-3 py-1.5 max-w-[90%]';
              } else {
                faceFeedback.className = 'absolute left-1/2 bottom-2 -translate-x-1/2 rounded-lg bg-black/70 px-3 py-1.5 max-w-[90%]';
              }
              
              // Update liveness score if provided
              if (score !== null && score !== undefined) {
                currentLivenessScore = score;
                livenessProgress.style.width = currentLivenessScore + '%';
                livenessScore.textContent = currentLivenessScore + '%';
                
                // Update progress bar color - require 50% for green
                if (currentLivenessScore >= 50) {
                  livenessProgress.className = 'bg-green-500 h-full transition-all duration-300';
                } else if (currentLivenessScore >= 30) {
                  livenessProgress.className = 'bg-yellow-500 h-full transition-all duration-300';
                } else {
                  livenessProgress.className = 'bg-red-500 h-full transition-all duration-300';
                }
              }
              
              // Show/hide countdown
              if (secondsRemaining !== null && secondsRemaining !== undefined && secondsRemaining > 0) {
                steadyCountdown.classList.remove('hidden');
                steadySeconds.textContent = secondsRemaining;
              } else {
                steadyCountdown.classList.add('hidden');
              }
            }
          });
        }

        // Start Face Detection
        startFaceBtn.addEventListener('click', async function() {
          startFaceBtn.disabled = true;
          faceStatusBadge.textContent = 'Starting...';
          faceStatusBadge.className = 'px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-700';
          
          // Reset preview and guide circle
          facePreviewImage.classList.add('hidden');
          faceNoCapture.classList.remove('hidden');
          faceVerificationResult.classList.add('hidden');
          livenessProgress.style.width = '0%';
          livenessScore.textContent = '0%';
          
          // Reset guide circle
          const guideCircle = document.getElementById('face-guide-circle');
          guideCircle.className = 'face-guide-circle w-48 h-48 rounded-full border-4 border-dashed border-white/70 transition-all duration-300';
          
          const started = await window.FaceDetection.startCamera();
          
          if (started) {
            startFaceBtn.style.display = 'none';
            stopFaceBtn.style.display = 'inline-flex';
            faceStatusBadge.textContent = 'Detecting...';
            faceStatusBadge.className = 'px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-700';
          } else {
            startFaceBtn.disabled = false;
            faceStatusBadge.textContent = 'Error';
            faceStatusBadge.className = 'px-3 py-1 rounded-full text-xs font-medium bg-red-100 text-red-700';
          }
        });

        // Stop Face Detection
        stopFaceBtn.addEventListener('click', function() {
          window.FaceDetection.stopCamera();
          stopFaceBtn.style.display = 'none';
          startFaceBtn.style.display = 'inline-flex';
          startFaceBtn.disabled = false;
          
          // Reset guide circle
          const guideCircle = document.getElementById('face-guide-circle');
          guideCircle.className = 'face-guide-circle w-48 h-48 rounded-full border-4 border-dashed border-white/70 transition-all duration-300';
          
          if (faceStatusBadge.textContent !== 'Verified' && faceStatusBadge.textContent !== 'Failed') {
            faceStatusBadge.textContent = 'Stopped';
            faceStatusBadge.className = 'px-3 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-600';
          }
          
          const feedbackDiv = faceFeedback.querySelector('div');
          feedbackDiv.textContent = 'Press Start button below';
          faceFeedback.className = 'absolute left-1/2 bottom-2 -translate-x-1/2 rounded-lg bg-black/70 px-3 py-1.5 max-w-[90%]';
        });
      })();
    </script>
</body>
</html>